{"id":"opencode-swarm-monorepo-lf2p4u-mjepneb3e6h","title":"Fix remaining 9 test failures","description":"Three distinct issue groups:\n\n1. **swarm_decompose/plan_prompt** (3 failures) - Prompt content assertions failing. Tests expect certain content in generated prompts that isn't there.\n\n2. **Checkpoint/Recovery** (3 failures) - \"there is no unique or exclusion constraint matching the ON CONFLICT specification\" - The swarm_contexts table is missing a unique constraint needed for UPSERT operations.\n\n3. **FTS search** (1 failure) - Full-text search fallback test failing. Likely missing FTS5 virtual table or triggers in test setup.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-20T19:48:02.991Z","updated_at":"2025-12-20T20:02:34.360Z","closed_at":"2025-12-20T20:02:34.360Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjepneb7ybq","title":"Fix swarm_decompose and swarm_plan_prompt tests","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-20T19:48:02.995Z","updated_at":"2025-12-20T20:02:27.546Z","closed_at":"2025-12-20T20:02:27.546Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjepneb3e6h","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjepneba91m","title":"Fix checkpoint/recovery - add unique constraint to swarm_contexts","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-20T19:48:02.998Z","updated_at":"2025-12-20T20:02:29.114Z","closed_at":"2025-12-20T20:02:29.114Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjepneb3e6h","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjepnebcihu","title":"Fix FTS search fallback test","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-20T19:48:03.000Z","updated_at":"2025-12-20T20:02:30.940Z","closed_at":"2025-12-20T20:02:30.940Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjepneb3e6h","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjf9s8wtmt1","title":"Test cell from debug session","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T05:11:41.597Z","updated_at":"2025-12-21T05:13:10.413Z","closed_at":"2025-12-21T05:13:10.413Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9ovwf","title":"Migration runner with schema validation","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-21T05:17:13.836Z","updated_at":"2025-12-21T05:41:15.798Z","closed_at":"2025-12-21T05:41:15.798Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9kgo7","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9zuyq","title":"Integration tests: hive_* tools (9 tools)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T05:17:13.847Z","updated_at":"2025-12-21T05:41:40.541Z","closed_at":"2025-12-21T05:41:40.541Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9kgo7","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjf9zda165l","title":"Integration tests: agentmail_* tools (11 tools)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T05:17:13.849Z","updated_at":"2025-12-21T05:41:41.871Z","closed_at":"2025-12-21T05:41:41.871Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9kgo7","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjf9zda2hg5","title":"Integration tests: semantic_memory_* tools (8 tools)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T05:17:13.850Z","updated_at":"2025-12-21T05:41:43.066Z","closed_at":"2025-12-21T05:41:43.066Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9kgo7","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjf9zda4z0b","title":"Integration tests: swarm_* tools (24 tools)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T05:17:13.852Z","updated_at":"2025-12-21T05:41:44.165Z","closed_at":"2025-12-21T05:41:44.165Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9kgo7","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjf9zda632z","title":"Integration tests: skills_* tools (9 tools)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T05:17:13.854Z","updated_at":"2025-12-21T05:41:16.982Z","closed_at":"2025-12-21T05:41:16.982Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9kgo7","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjf9zda7324","title":"Integration tests: structured_* + mandate_* tools (10 tools)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T05:17:13.855Z","updated_at":"2025-12-21T05:41:18.306Z","closed_at":"2025-12-21T05:41:18.306Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9kgo7","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjf9zda9lvj","title":"Integration tests: repo_* tools (5 tools)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T05:17:13.857Z","updated_at":"2025-12-21T05:41:19.312Z","closed_at":"2025-12-21T05:41:19.312Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9kgo7","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9rprs","title":"Convert streams subsystem to Drizzle queries","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T05:17:13.839Z","updated_at":"2025-12-21T16:21:02.703Z","closed_at":"2025-12-21T16:21:02.703Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9kgo7","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9uul8","title":"Convert memory subsystem to Drizzle queries","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T05:17:13.842Z","updated_at":"2025-12-21T16:21:03.936Z","closed_at":"2025-12-21T16:21:03.936Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9kgo7","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9vceg","title":"Convert hive subsystem to Drizzle queries","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T05:17:13.843Z","updated_at":"2025-12-21T17:24:31.341Z","closed_at":"2025-12-21T17:24:31.341Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9kgo7","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfxpg2wbk8","title":"Port DurableLock to libSQL","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T16:21:21.704Z","updated_at":"2025-12-21T16:27:15.787Z","closed_at":"2025-12-21T16:27:15.787Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjfxpg2p165","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfxpg2zg9f","title":"Port DurableDeferred to libSQL","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T16:21:21.707Z","updated_at":"2025-12-21T16:37:40.796Z","closed_at":"2025-12-21T16:37:40.796Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjfxpg2p165","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfxpg31hwz","title":"Port DurableCursor to libSQL","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T16:21:21.709Z","updated_at":"2025-12-21T16:37:42.151Z","closed_at":"2025-12-21T16:37:42.151Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjfxpg2p165","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfxpg33y71","title":"Port DurableMailbox and ask pattern to libSQL","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T16:21:21.711Z","updated_at":"2025-12-21T16:48:17.096Z","closed_at":"2025-12-21T16:48:17.096Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjfxpg2p165","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfxpg35hv2","title":"Remove PGLite from streams/index.ts exports","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T16:21:21.713Z","updated_at":"2025-12-21T17:24:33.638Z","closed_at":"2025-12-21T17:24:33.638Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjfxpg2p165","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfyo44apwt","title":"Add Haiku-Powered Compaction Analysis","description":"Wire liteModel into plugin template and use it for pre-analysis during compaction.\n\n1. Parameterize getPluginWrapper() to accept liteModel\n2. Update compaction hook to call `opencode run -m <liteModel>` for pre-analysis\n3. Use output.prompt to replace compaction prompt with pre-analyzed state\n\nThis enables smarter compaction that preserves swarm state for continuation.","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-21T16:48:19.162Z","updated_at":"2025-12-21T16:48:19.162Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfzlbckh37","title":"Create Hive/Cell Visualizer","description":"Build a visualizer for hive cells inspired by https://github.com/Dicklesworthstone/beads_viewer\n\nCould show:\n- Epic/subtask hierarchy\n- Cell status (open, in_progress, blocked, closed)\n- Dependencies between cells\n- Agent assignments\n- File reservations","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-21T17:14:08.180Z","updated_at":"2025-12-21T17:14:08.180Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfzm2qunwj","title":"Analyze agentic_coding_flywheel_setup for ideas","description":"Analyze https://github.com/Dicklesworthstone/agentic_coding_flywheel_setup for ideas to extract and improve our swarm system.\n\nLook for:\n- Workflow patterns\n- Agent coordination strategies\n- Learning/feedback loops\n- Tool integration patterns","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-21T17:14:43.686Z","updated_at":"2025-12-21T17:14:43.686Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfznai9mco","title":"Add Drizzle Kit migrations","description":"Use drizzle-kit for proper schema migrations instead of manual CREATE TABLE IF NOT EXISTS.\n\nBenefits:\n- Automatic migration generation from schema changes\n- Version tracking\n- Rollback support\n- Type-safe migrations\n\nWould replace the current ad-hoc migration logic in libsql-schema.ts.","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-21T17:15:40.401Z","updated_at":"2025-12-21T17:15:40.401Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfzgw9c7gd","title":"Fix: SQLITE_ERROR no such column: stream in hive_create_epic","description":"When calling hive_create_epic, get error: SQLITE_ERROR: no such column: stream\n\nContext:\n- Happens when creating epic in a project\n- swarmmail_init may be reusing wrong project context\n- Schema migration may not have run on hive database\n\nLikely causes:\n1. Schema migration not run on hive SQLite database\n2. Wrong database being accessed (project path mismatch)\n3. cursors table schema change (stream column) not applied to existing DBs\n\nRelated to PGLite→libSQL migration - the cursors table schema changed from stream_id to stream column.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-21T17:10:42.000Z","updated_at":"2025-12-21T17:26:06.716Z","closed_at":"2025-12-21T17:26:06.716Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg00gnvf8y","title":"Fix P0: cursors table schema migration (stream column)","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-21T17:25:54.907Z","updated_at":"2025-12-21T17:32:38.681Z","closed_at":"2025-12-21T17:32:38.681Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjg00gnmwui","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg00go0fga","title":"Fix agentmail_release integration tests (3 failing)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T17:25:54.912Z","updated_at":"2025-12-21T17:37:03.773Z","closed_at":"2025-12-21T17:37:03.773Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjg00gnmwui","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg00go89jn","title":"Fix swarm_checkpoint integration tests (2 failing)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T17:25:54.920Z","updated_at":"2025-12-21T17:37:06.462Z","closed_at":"2025-12-21T17:37:06.462Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjg00gnmwui","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg01a7xgtu","title":"Bug: hive_update cannot close cells (CHECK constraint fails)","description":"When calling hive_update with status='closed', get error:\n\n```\nSQLITE_CONSTRAINT_CHECK: CHECK constraint failed: (status = 'closed') = (closed_at IS NOT NULL)\n```\n\nRoot cause: The beads table has a CHECK constraint requiring closed_at to be set when status='closed'. hive_update doesn't set closed_at when changing status to closed.\n\nFix: Either:\n1. hive_update should set closed_at = NOW() when status='closed'\n2. Or hive_update should reject status='closed' and require hive_close instead\n\nLocation: packages/swarm-mail/src/hive/adapter.ts (updateCell method)","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-21T17:26:33.213Z","updated_at":"2025-12-21T17:32:40.860Z","closed_at":"2025-12-21T17:32:40.860Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg00gnmwui","title":"Fix P0 Schema Bug + Integration Tests + Effect Primitives","description":"Sequential risk-based approach: Fix cursors schema migration bug (P0), then fix 6 failing integration tests, consolidate duplicate schemas, and integrate DurableLock/DurableDeferred into swarm coordination.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-21T17:25:54.898Z","updated_at":"2025-12-21T17:48:25.022Z","closed_at":"2025-12-21T17:48:25.022Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg00goagh1","title":"Consolidate duplicate schema definitions","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T17:25:54.922Z","updated_at":"2025-12-21T17:45:23.718Z","closed_at":"2025-12-21T17:45:23.718Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjg00gnmwui","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg00god17i","title":"Port DurableLock to libSQL/DatabaseAdapter","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T17:25:54.925Z","updated_at":"2025-12-21T17:48:17.068Z","closed_at":"2025-12-21T17:48:17.068Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjg00gnmwui","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg00gogwct","title":"Port DurableDeferred to libSQL/DatabaseAdapter","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T17:25:54.928Z","updated_at":"2025-12-21T17:48:18.268Z","closed_at":"2025-12-21T17:48:18.268Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjg00gnmwui","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9kgo7","title":"Drizzle Migration + Plugin Integration Tests","description":"Convert all raw SQL to Drizzle ORM with proper migrations. Add happy-path integration tests for all 93 plugin tools. TDD approach: test first, then implement.\n\nBranch: feat/drizzle-migration-and-tests\n\n## Phase 1: Foundation (sequential)\n- Migration runner with schema validation\n\n## Phase 2: Drizzle Conversion (parallel after Phase 1)\n- Convert streams subsystem\n- Convert memory subsystem  \n- Convert hive subsystem\n\n## Phase 3: Cleanup (after Phase 2)\n- Remove duplicate schema definitions\n\n## Phase 4: Integration Tests (parallel, some depend on Phase 2)\n- hive_* tools (9)\n- agentmail_* tools (11)\n- semantic_memory_* tools (8)\n- swarm_* tools (24)\n- skills_* tools (9)\n- structured_* + mandate_* tools (10)\n- repo_* tools (5)","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-21T05:17:13.832Z","updated_at":"2025-12-21T18:01:12.967Z","closed_at":"2025-12-21T18:01:12.967Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9xs46","title":"Remove duplicate schema definitions","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T05:17:13.845Z","updated_at":"2025-12-21T18:01:04.308Z","closed_at":"2025-12-21T18:01:04.308Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjf9zd9kgo7","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfvn2w3yuv","title":"Drizzle Migration Phase 2: Fix Tests + Hive Conversion","description":"Complete Drizzle migration for swarm-mail package.\n\n## Context\n- Streams subsystem: ✅ Done (wrappers added)\n- Memory subsystem: ✅ Done (already uses Drizzle)\n- Hive subsystem: ❌ Still uses DatabaseAdapter with raw SQL\n\n## Approach\nKeep HiveAdapter interface, rewrite internals to use Drizzle ORM.\nFollow course-builder adapter-drizzle pattern: interface in core, Drizzle implementation under the hood.\n\n## Shared Context for Workers\n- Use `toSwarmDb()` to convert DatabaseAdapter → SwarmDb (Drizzle client)\n- Create wrapper functions matching old signatures for backward compat\n- Keep complex CTEs as raw SQL via `sql.raw()` if Drizzle can't express them\n- Schema source of truth: `packages/swarm-mail/src/db/schema/hive.ts`\n\n## Dependencies\n- Task 1 (fix tests) unblocks CI\n- Task 2 (hive conversion) is the main work\n- Task 3 (schema consolidation) depends on Task 2","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-21T15:23:32.067Z","updated_at":"2025-12-21T18:01:05.723Z","closed_at":"2025-12-21T18:01:05.723Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfvn2w82v6","title":"Fix 6 failing integration tests (CI blocker)","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-21T15:23:32.072Z","updated_at":"2025-12-21T18:00:54.686Z","closed_at":"2025-12-21T18:00:54.686Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjfvn2w3yuv","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfvn2wanib","title":"Convert hive/store.ts to Drizzle","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T15:23:32.074Z","updated_at":"2025-12-21T18:00:56.179Z","closed_at":"2025-12-21T18:00:56.179Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjfvn2w3yuv","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfvn2wcdxt","title":"Convert hive/projections.ts to Drizzle","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T15:23:32.076Z","updated_at":"2025-12-21T18:00:57.636Z","closed_at":"2025-12-21T18:00:57.636Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjfvn2w3yuv","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfvn2webre","title":"Convert hive/queries.ts to Drizzle (or keep raw SQL for complex CTEs)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T15:23:32.078Z","updated_at":"2025-12-21T18:00:59.516Z","closed_at":"2025-12-21T18:00:59.516Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjfvn2w3yuv","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfvn2wggoh","title":"Convert hive/comments.ts, labels.ts, dependencies.ts to Drizzle","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:23:32.080Z","updated_at":"2025-12-21T18:01:01.046Z","closed_at":"2025-12-21T18:01:01.046Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjfvn2w3yuv","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfvn2wiku9","title":"Consolidate duplicate schema definitions","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T15:23:32.082Z","updated_at":"2025-12-21T18:01:02.609Z","closed_at":"2025-12-21T18:01:02.609Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjfvn2w3yuv","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfxpg2p165","title":"Remove PGLite, Port Effect Primitives to libSQL","description":"Complete removal of PGLite infrastructure (except migration tools), port all Effect-TS durable primitives to use libSQL/DatabaseAdapter, and integrate DurableLock + DurableDeferred into swarm worker coordination.\n\n## Context\n- Upstream source: https://github.com/durable-streams/durable-streams\n- Effect primitives: DurableLock, DurableDeferred, DurableCursor, DurableMailbox\n- Current state: primitives use getDatabase() which returns PGLite\n- Target state: primitives accept DatabaseAdapter parameter (libSQL)\n\n## Execution Order\n1. Tasks 0-2 in parallel (Lock, Deferred, Cursor)\n2. Task 3 after 0-2 (Mailbox + ask pattern)\n3. Task 4 after 3 (Remove PGLite from exports)\n4. Tasks 5-6 in parallel after 4 (Integration into swarm)","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-21T16:21:21.697Z","updated_at":"2025-12-21T18:05:01.905Z","closed_at":"2025-12-21T18:05:01.905Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfxpg37mzq","title":"Integrate DurableLock into swarm file reservations","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T16:21:21.715Z","updated_at":"2025-12-21T18:05:03.058Z","closed_at":"2025-12-21T18:05:03.058Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjfxpg2p165","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjfxpg39jw6","title":"Integrate DurableDeferred into swarm task completion","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T16:21:21.717Z","updated_at":"2025-12-21T18:05:04.159Z","closed_at":"2025-12-21T18:05:04.159Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjfxpg2p165","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg1elo7hfg","title":"Remove PGLite dead code from streams/index.ts","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T18:04:54.199Z","updated_at":"2025-12-21T18:11:33.570Z","closed_at":"2025-12-21T18:11:33.570Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjg1elo0g21","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg1elo0g21","title":"PGLite Cleanup + Effect Primitives Integration","description":"Remove dead PGLite code from streams/index.ts, integrate DurableLock into swarm file reservations, integrate DurableDeferred into swarm task completion. YOLO for v0.31.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-21T18:04:54.192Z","updated_at":"2025-12-21T18:24:36.778Z","closed_at":"2025-12-21T18:24:36.778Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg1elo9uoa","title":"Integrate DurableLock into swarm file reservations","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T18:04:54.201Z","updated_at":"2025-12-21T18:24:34.312Z","closed_at":"2025-12-21T18:24:34.312Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjg1elo0g21","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg1eloagne","title":"Integrate DurableDeferred into swarm task completion","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T18:04:54.202Z","updated_at":"2025-12-21T18:24:35.188Z","closed_at":"2025-12-21T18:24:35.188Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjg1elo0g21","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg23zk1qi7","title":"Remove UBS scan from swarm_complete","description":"Remove the UBS scan step from swarm_complete. It's slowing things down and not providing value for the release.","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-21T18:24:38.593Z","updated_at":"2025-12-21T18:25:47.204Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg2uw8rcvo","title":"Consolidate per-project DBs to centralized global DB","description":"Currently each project gets its own `.opencode/streams.db` database, with fallback to `~/.opencode/streams.db`. This causes:\n\n1. **Schema drift** - Different projects have different schema versions, causing \"no such column: stream\" errors\n2. **Migration complexity** - Need to migrate each project's DB separately\n3. **Disk bloat** - Multiple copies of similar data\n4. **Cross-project queries impossible** - Can't search across all projects\n\n**Proposed solution:**\n- Single global `~/.opencode/swarm-mail.db` for all projects\n- Project isolation via `project_key` column (already exists in schema)\n- Single migration path\n- Optional per-project override for special cases\n\n**Migration path:**\n1. Add migration tool to merge existing per-project DBs into global\n2. Update `getSwarmMailLibSQL()` to prefer global DB\n3. Deprecate per-project DB creation\n4. Clean up old per-project DBs after successful migration\n\n**Related issues:**\n- \"SQLITE_ERROR: no such column: stream\" errors in tests and other sessions\n- PGLite → libSQL migration incomplete in some projects","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-21T18:45:34.011Z","updated_at":"2025-12-21T19:10:18.780Z","closed_at":"2025-12-21T19:10:18.780Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg37qv7vim","title":"Auto-migration to centralized swarm tools database","description":"On swarmmail_init, detect old per-project DBs (.opencode/streams.db or .opencode/streams/ PGLite), migrate data to global ~/.opencode/swarm-mail.db, rename old DB to .backup with timestamp. Fast check on init, handles both libSQL and PGLite sources.\n\n## Design Decisions\n- Trigger: On swarmmail_init (natural entry point, once per session)\n- Old DB handling: Rename to .backup-<timestamp> (safe rollback)\n- Global DB: ~/.opencode/swarm-mail.db\n- Project isolation: via project_key column (already exists)\n\n## Lore (from DDIA)\n\"In most cases, a change to an application's features also requires a change to data that it stores\" - handle schema evolution gracefully, missing tables are OK.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-21T18:55:33.572Z","updated_at":"2025-12-21T19:10:16.910Z","closed_at":"2025-12-21T19:10:16.910Z","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg37qvlyi9","title":"Create complete auto-migration module","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-21T18:55:33.585Z","updated_at":"2025-12-21T19:09:14.664Z","closed_at":"2025-12-21T19:09:14.664Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjg37qv7vim","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg37qvom6o","title":"Update getDatabasePath to use global DB","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-21T18:55:33.588Z","updated_at":"2025-12-21T19:09:16.029Z","closed_at":"2025-12-21T19:09:16.029Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjg37qv7vim","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg37qvrqhw","title":"Integrate auto-migration into swarmmail_init","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T18:55:33.591Z","updated_at":"2025-12-21T19:09:17.831Z","closed_at":"2025-12-21T19:09:17.831Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjg37qv7vim","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg37qw04am","title":"Add tests for auto-migration","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T18:55:33.600Z","updated_at":"2025-12-21T19:09:19.036Z","closed_at":"2025-12-21T19:09:19.036Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjg37qv7vim","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg37qw2oq7","title":"Update exports and documentation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T18:55:33.602Z","updated_at":"2025-12-21T19:10:14.566Z","closed_at":"2025-12-21T19:10:14.566Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjg37qv7vim","dependencies":[],"labels":[],"comments":[]}
{"id":"opencode-swarm-monorepo-lf2p4u-mjg3injmw1p","title":"Fix global DB path: ~/.config/swarm-tools/swarm.db","description":"User requested path change after initial implementation.\n\nChange from: ~/.opencode/swarm-mail.db\nChange to: ~/.config/swarm-tools/swarm.db\n\nFiles to update:\n1. packages/swarm-mail/src/streams/auto-migrate.ts - getGlobalDbPath()\n2. packages/swarm-mail/src/streams/index.ts - getDatabasePath()\n3. Any tests that reference the old path\n\nRationale: Cleaner separation from OpenCode config, follows XDG conventions.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-21T19:04:02.482Z","updated_at":"2025-12-21T19:09:13.065Z","closed_at":"2025-12-21T19:09:13.065Z","parent_id":"opencode-swarm-monorepo-lf2p4u-mjg37qv7vim","dependencies":[],"labels":[],"comments":[]}
